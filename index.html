<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>合約管理架構系統</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            border: 1px solid #d0d7e7;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            position: relative;
        }
        
        .ste-logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .ste-logo {
            height: 120px;
            width: auto;
            max-width: 300px;
            object-fit: contain;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
            transition: transform 0.3s ease;
        }
        
        .ste-logo:hover {
            transform: scale(1.05);
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #2c3e50 0%, #4a6491 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .subtitle {
            font-size: 1.6rem;
            color: #4a6491;
            margin-bottom: 20px;
        }
        
        .instructions {
            text-align: center;
            margin-top: 20px;
            color: #5a6b8c;
            font-size: 1.3rem;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #d0d7e7;
        }
        
        .tree-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid #d0d7e7;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .tree-title {
            font-size: 2rem;
            margin-bottom: 25px;
            color: #2c3e50;
            border-bottom: 3px solid rgba(74, 100, 145, 0.3);
            padding-bottom: 15px;
            text-align: center;
        }
        
        /* 樹狀圖樣式 - 修正版 */
        .tree {
            font-size: 1.5rem;
            line-height: 1.8;
        }
        
        .tree ul {
            padding-left: 30px;
            list-style-type: none;
            transition: all 0.3s ease;
        }
        
        .tree li {
            position: relative;
            margin-bottom: 8px;
        }
        
        .tree li:before {
            content: '';
            position: absolute;
            left: -20px;
            top: 24px;
            width: 16px;
            height: 2px;
            background: rgba(74, 100, 145, 0.5);
        }
        
        .tree li:after {
            content: '';
            position: absolute;
            left: -20px;
            top: 24px;
            height: calc(100% - 24px);
            width: 2px;
            background: rgba(74, 100, 145, 0.5);
        }
        
        .tree li:last-child:after {
            height: 0;
        }
        
        .tree-item {
            cursor: pointer;
            padding: 18px 25px;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            border-left: 4px solid transparent;
            font-size: 1.5rem;
            border: 1px solid #e1e6f0;
            margin-bottom: 5px;
        }
        
        .tree-item:hover {
            background: rgba(74, 100, 145, 0.1);
            transform: translateX(5px);
            border-left: 4px solid #4a6491;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .tree-item.active {
            background: rgba(74, 100, 145, 0.15);
            border-left: 4px solid #4a6491;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .tree-item i {
            margin-right: 15px;
            font-size: 1.5rem;
            color: #4a6491;
        }
        
        .item-content {
            font-size: 1.6rem;
            color: #2c3e50;
            font-weight: 500;
        }
        
        .file-item {
            color: #2c7da0;
            background: rgba(44, 125, 160, 0.08);
        }
        
        .toggle-icon {
            margin-left: auto;
            transition: transform 0.3s ease;
            color: #4a6491;
            font-size: 1.3rem;
            min-width: 20px;
            text-align: center;
        }
        
        .toggle-icon.rotated {
            transform: rotate(180deg);
        }
        
        .children-container {
            padding-left: 30px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .children-container.collapsed {
            max-height: 0;
        }
        
        .children-container.expanded {
            max-height: 5000px;
        }
        
        .file-list {
            list-style-type: none;
            padding-left: 25px;
            margin-top: 5px;
        }
        
        .file-list li {
            padding: 10px 15px;
            margin-bottom: 5px;
            background: rgba(44, 125, 160, 0.08);
            border-radius: 8px;
            border-left: 3px solid #2c7da0;
            font-size: 1.4rem;
        }
        
        .file-list i {
            margin-right: 10px;
            color: #2c7da0;
            font-size: 1.3rem;
        }
        
        /* 控制按鈕 */
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 18px 30px;
            font-size: 1.4rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: #4a6491;
            color: white;
            border: 2px solid #4a6491;
            font-weight: 600;
        }
        
        .btn:hover {
            background: #3a5479;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        .btn i {
            font-size: 1.5rem;
        }
        
        /* 響應式設計 */
        @media (max-width: 768px) {
            .ste-logo {
                height: 80px;
                max-width: 200px;
            }
            
            h1 {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1.4rem;
            }
            
            .tree-title {
                font-size: 1.8rem;
            }
            
            .tree-item, .item-content {
                font-size: 1.4rem;
            }
            
            .tree {
                font-size: 1.4rem;
            }
            
            .btn {
                padding: 15px 25px;
                font-size: 1.3rem;
            }
            
            .tree ul {
                padding-left: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .ste-logo {
                height: 60px;
                max-width: 180px;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <!-- STE LOGO 區塊 -->
            <div class="ste-logo-container">
                <img src="https://i.urusai.cc/Qlsat.png" alt="STE LOGO" class="ste-logo">
            </div>
            
            <h1>合約管理架構</h1>
            <p class="subtitle">架構說明</p>
        </header>
        
        <div class="tree-container">
            <h2 class="tree-title"><i class="fas fa-sitemap"></i> 合約管理架構樹狀圖</h2>
            <div class="tree" id="contractTree">
                <!-- 樹狀圖將由JavaScript動態生成 -->
            </div>
        </div>
        
        <div class="controls">
            <button class="btn" id="expandAll">
                <i class="fas fa-expand-alt"></i> 展開所有項目
            </button>
            <button class="btn" id="collapseAll">
                <i class="fas fa-compress-alt"></i> 摺疊所有項目
            </button>
        </div>
        
        <div class="instructions">
            <p>點擊項目可展開/摺疊子項目 | 點擊「展開所有項目」可查看完整架構 | 點擊「摺疊所有項目」可收起所有子項目</p>
        </div>
    </div>

    <script>
        // 創建相同的子結構函數
        function createSubStructure(prefix) {
            return [
                {
                    "id": prefix + "ongoing",
                    "name": "01. 已發生 & 進行中",
                    "icon": "fas fa-spinner",
                    "children": [
                        {
                            "id": prefix + "extension",
                            "name": "01. 工期展延",
                            "icon": "fas fa-calendar-plus",
                            "children": [
                                {
                                    "id": prefix + "eot1",
                                    "name": "01. EOT-1",
                                    "icon": "fas fa-clock",
                                    "children": [
                                        {
                                            "id": prefix + "dispute-prep",
                                            "name": "00. 爭議準備",
                                            "icon": "fas fa-gavel",
                                            "children": [
                                                {
                                                    "id": prefix + "doc-record",
                                                    "name": "01. 公文往來紀錄",
                                                    "icon": "fas fa-envelope"
                                                },
                                                {
                                                    "id": prefix + "meeting-history",
                                                    "name": "02. 審查會議歷程 (含提送展延申請)",
                                                    "icon": "fas fa-users"
                                                },
                                                {
                                                    "id": prefix + "cost-organize",
                                                    "name": "03. 衍生費用整理",
                                                    "icon": "fas fa-calculator",
                                                    "children": [
                                                        {"id": prefix + "personnel", "name": "01. 人事費用", "icon": "fas fa-user-tie"},
                                                        {"id": prefix + "equipment", "name": "02. 工程設備維護及延長保固費", "icon": "fas fa-tools"},
                                                        {"id": prefix + "storage", "name": "03. 倉儲租賃費", "icon": "fas fa-warehouse"},
                                                        {"id": prefix + "guarantee", "name": "04. 延長保證費用", "icon": "fas fa-shield-alt"},
                                                        {"id": prefix + "insurance", "name": "05. 延長保險費用", "icon": "fas fa-file-invoice-dollar"},
                                                        {"id": prefix + "office", "name": "06. 專案辦公室營運費用", "icon": "fas fa-building"},
                                                        {"id": prefix + "electricity", "name": "07. 工區臨時電費", "icon": "fas fa-bolt"},
                                                        {"id": prefix + "equipment-rental", "name": "08. 施工機具設備租賃費", "icon": "fas fa-truck"},
                                                        {"id": prefix + "mobilization", "name": "09. 停復工動員費", "icon": "fas fa-hard-hat"},
                                                        {"id": prefix + "subcontractor", "name": "10. 分包商求償費", "icon": "fas fa-handshake"},
                                                        {"id": prefix + "material", "name": "11. 材料設備上漲價差", "icon": "fas fa-boxes"},
                                                        {"id": prefix + "monitoring", "name": "12. 監測安衛品管費", "icon": "fas fa-clipboard-check"},
                                                        {"id": prefix + "management", "name": "13. 總公司管理費", "icon": "fas fa-landmark"},
                                                        {"id": prefix + "other", "name": "14. 其他項目", "icon": "fas fa-list-ul"},
                                                        {
                                                            "id": prefix + "cost-record-file",
                                                            "name": "[檔案] 衍生費用紀錄",
                                                            "icon": "fas fa-file-excel",
                                                            "file": true
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "id": prefix + "extension-history-file",
                                            "name": "[檔案] 工期展延歷程",
                                            "icon": "fas fa-file-alt",
                                            "file": true
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "id": prefix + "dispute-handling",
                            "name": "02. 履約爭議處理",
                            "icon": "fas fa-balance-scale"
                        }
                    ]
                },
                {
                    "id": prefix + "dispute-prep-main",
                    "name": "02. 爭議準備",
                    "icon": "fas fa-folder",
                    "children": [
                        {
                            "id": prefix + "owner",
                            "name": "01. 業主",
                            "icon": "fas fa-user-tie",
                            "children": [
                                {"id": prefix + "owner-dispute1", "name": "01. XXX 爭議", "icon": "fas fa-exclamation-triangle"},
                                {"id": prefix + "owner-dispute2", "name": "02. XXX 爭議", "icon": "fas fa-exclamation-triangle"},
                                {
                                    "id": prefix + "owner-dispute-file",
                                    "name": "[檔案] 其他爭議清單",
                                    "icon": "fas fa-file-contract",
                                    "file": true
                                }
                            ]
                        },
                        {
                            "id": prefix + "joint-contractor",
                            "name": "02. 共同承攬廠商",
                            "icon": "fas fa-hands-helping",
                            "children": [
                                {"id": prefix + "joint-dispute1", "name": "01. XXX 爭議", "icon": "fas fa-exclamation-triangle"},
                                {"id": prefix + "joint-dispute2", "name": "02. XXX 爭議", "icon": "fas fa-exclamation-triangle"},
                                {
                                    "id": prefix + "joint-dispute-file",
                                    "name": "[檔案] 其他爭議清單",
                                    "icon": "fas fa-file-contract",
                                    "file": true
                                }
                            ]
                        },
                        {
                            "id": prefix + "subcontractor-prep",
                            "name": "03. 分包廠商",
                            "icon": "fas fa-user-friends",
                            "children": [
                                {"id": prefix + "sub-dispute1", "name": "01. XXX 爭議", "icon": "fas fa-exclamation-triangle"},
                                {"id": prefix + "sub-dispute2", "name": "02. XXX 爭議", "icon": "fas fa-exclamation-triangle"},
                                {
                                    "id": prefix + "sub-dispute-file",
                                    "name": "[檔案] 其他爭議清單",
                                    "icon": "fas fa-file-contract",
                                    "file": true
                                }
                            ]
                        }
                    ]
                },
                {
                    "id": prefix + "contract-change",
                    "name": "03. 契約變更",
                    "icon": "fas fa-edit",
                    "children": [
                        {
                            "id": prefix + "cco1",
                            "name": "01. CCO-01-01_「雇主意外責任險未能採扣除社會保險之給付」依採購契約規定辦理契約變更",
                            "icon": "fas fa-file-signature"
                        },
                        {
                            "id": prefix + "cco2",
                            "name": "02. CCO-02-01_新增車輛等比例模型設置規劃契約變更",
                            "icon": "fas fa-file-signature"
                        },
                        {
                            "id": prefix + "cco3",
                            "name": "03. CCO-03-01_工程保險費以檢具核銷方式辦理估驗計價之契約變更",
                            "icon": "fas fa-file-signature"
                        },
                        {
                            "id": prefix + "change-list-file",
                            "name": "[檔案] 契約變更清單",
                            "icon": "fas fa-clipboard-list",
                            "file": true
                        }
                    ]
                }
            ];
        }

        // 合約管理架構數據
        const contractData = {
            "id": "root",
            "name": "合約管理架構",
            "children": [
                {
                    "id": "upload",
                    "name": "01. 資料上傳",
                    "icon": "fas fa-cloud-upload-alt",
                    "children": createSubStructure("upload-")
                },
                {
                    "id": "organize",
                    "name": "02. 資料整理",
                    "icon": "fas fa-folder-open",
                    "children": createSubStructure("organize-")
                }
            ]
        };

        // DOM元素
        const treeContainer = document.getElementById('contractTree');
        
        // 初始化樹狀圖
        function renderTree(node, parentElement, level = 0) {
            // 創建項目容器
            const li = document.createElement('li');
            li.id = `li-${node.id}`;
            
            // 創建項目本身
            const itemDiv = document.createElement('div');
            itemDiv.className = `tree-item ${node.file ? 'file-item' : ''}`;
            itemDiv.dataset.id = node.id;
            itemDiv.dataset.level = level;
            
            // 添加圖標和內容
            const icon = document.createElement('i');
            icon.className = node.icon || (node.file ? 'fas fa-file' : 'fas fa-folder');
            itemDiv.appendChild(icon);
            
            const contentSpan = document.createElement('span');
            contentSpan.className = 'item-content';
            contentSpan.textContent = node.name;
            itemDiv.appendChild(contentSpan);
            
            // 如果有子項目，添加展開/摺疊圖標
            if (node.children && node.children.length > 0) {
                const toggleIcon = document.createElement('i');
                toggleIcon.className = 'fas fa-chevron-right toggle-icon';
                itemDiv.appendChild(toggleIcon);
                
                // 修改這裡：預設只顯示第一層（level 0），所以初始狀態全部摺疊
                let isExpanded = false;
                
                // 創建子項目容器
                const childrenContainer = document.createElement('div');
                childrenContainer.className = `children-container ${isExpanded ? 'expanded' : 'collapsed'}`;
                childrenContainer.id = `children-${node.id}`;
                
                // 點擊項目時切換展開/摺疊
                itemDiv.addEventListener('click', function(e) {
                    // 如果點擊的是圖標，不觸發
                    if (e.target.classList.contains('toggle-icon')) return;
                    
                    toggleChildren(node.id, childrenContainer, toggleIcon);
                });
                
                // 點擊圖標時切換展開/摺疊
                toggleIcon.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleChildren(node.id, childrenContainer, toggleIcon);
                });
                
                // 渲染子項目
                const childUl = document.createElement('ul');
                node.children.forEach(child => {
                    renderTree(child, childUl, level + 1);
                });
                childrenContainer.appendChild(childUl);
                
                li.appendChild(itemDiv);
                li.appendChild(childrenContainer);
            } else {
                // 沒有子項目的項目
                li.appendChild(itemDiv);
            }
            
            parentElement.appendChild(li);
        }
        
        // 切換子項目顯示/隱藏
        function toggleChildren(nodeId, container, toggleIcon) {
            const isCollapsed = container.classList.contains('collapsed');
            
            if (isCollapsed) {
                // 展開
                container.classList.remove('collapsed');
                container.classList.add('expanded');
                toggleIcon.className = 'fas fa-chevron-down toggle-icon rotated';
            } else {
                // 摺疊
                container.classList.remove('expanded');
                container.classList.add('collapsed');
                toggleIcon.className = 'fas fa-chevron-right toggle-icon';
            }
        }
        
        // 展開所有節點
        function expandAllNodes() {
            document.querySelectorAll('.children-container').forEach(container => {
                container.classList.remove('collapsed');
                container.classList.add('expanded');
            });
            
            document.querySelectorAll('.toggle-icon').forEach(icon => {
                icon.className = 'fas fa-chevron-down toggle-icon rotated';
            });
        }
        
        // 摺疊所有節點
        function collapseAllNodes() {
            document.querySelectorAll('.children-container').forEach(container => {
                container.classList.remove('expanded');
                container.classList.add('collapsed');
            });
            
            document.querySelectorAll('.toggle-icon').forEach(icon => {
                icon.className = 'fas fa-chevron-right toggle-icon';
            });
        }
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 創建主UL元素
            const mainUl = document.createElement('ul');
            mainUl.className = 'main-tree';
            
            // 渲染樹狀圖
            contractData.children.forEach(child => {
                renderTree(child, mainUl, 0);
            });
            
            treeContainer.appendChild(mainUl);
            
            // 綁定控制按鈕事件
            document.getElementById('expandAll').addEventListener('click', expandAllNodes);
            document.getElementById('collapseAll').addEventListener('click', collapseAllNodes);
        });
    </script>
</body>
</html>
